<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="530px" preserveAspectRatio="none" style="width:722px;height:530px;" version="1.1" viewBox="0 0 722 530" width="722px" zoomAndPan="magnify"><defs><filter height="300%" id="f1k03ztkfhq18d" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="515.0547" style="stroke: #A80036; stroke-width: 1.0;" width="409" x="98.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="281.5" y="16.0669">Prime</text><rect fill="#FFFFFF" filter="url(#f1k03ztkfhq18d)" height="318.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="26.5" y="96.2969"/><rect fill="#FFFFFF" filter="url(#f1k03ztkfhq18d)" height="297.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="139.5" y="117.4297"/><rect fill="#FFFFFF" filter="url(#f1k03ztkfhq18d)" height="126.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="360.5" y="259.0938"/><rect fill="#FFFFFF" filter="url(#f1k03ztkfhq18d)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="473.5" y="200.8281"/><rect fill="#FFFFFF" filter="url(#f1k03ztkfhq18d)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="607.5" y="288.2266"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="31" x2="31" y1="86.2969" y2="432.7578"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="144.5" x2="144.5" y1="86.2969" y2="432.7578"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="365.5" x2="365.5" y1="86.2969" y2="432.7578"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="478.5" x2="478.5" y1="86.2969" y2="432.7578"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="612.5" x2="612.5" y1="86.2969" y2="432.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="8" y="82.9951">Client</text><ellipse cx="31.5" cy="13" fill="#FEFECE" filter="url(#f1k03ztkfhq18d)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M31.5,21 L31.5,48 M18.5,29 L44.5,29 M31.5,48 L18.5,63 M31.5,48 L44.5,63 " fill="none" filter="url(#f1k03ztkfhq18d)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="8" y="444.7529">Client</text><ellipse cx="31.5" cy="458.0547" fill="#FEFECE" filter="url(#f1k03ztkfhq18d)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M31.5,466.0547 L31.5,493.0547 M18.5,474.0547 L44.5,474.0547 M31.5,493.0547 L18.5,508.0547 M31.5,493.0547 L44.5,508.0547 " fill="none" filter="url(#f1k03ztkfhq18d)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1k03ztkfhq18d)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="80" x="102.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="109.5" y="70.9951">client-api</text><rect fill="#FEFECE" filter="url(#f1k03ztkfhq18d)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="80" x="102.5" y="431.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="109.5" y="451.7529">client-api</text><rect fill="#FEFECE" filter="url(#f1k03ztkfhq18d)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="287.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="294.5" y="70.9951">payment-processor</text><rect fill="#FEFECE" filter="url(#f1k03ztkfhq18d)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="287.5" y="431.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="294.5" y="451.7529">payment-processor</text><rect fill="#FEFECE" filter="url(#f1k03ztkfhq18d)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="46" x="453.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="460.5" y="70.9951">DAO</text><rect fill="#FEFECE" filter="url(#f1k03ztkfhq18d)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="46" x="453.5" y="431.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="460.5" y="451.7529">DAO</text><rect fill="#FEFECE" filter="url(#f1k03ztkfhq18d)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="582.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="589.5" y="70.9951">Stripe</text><rect fill="#FEFECE" filter="url(#f1k03ztkfhq18d)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="582.5" y="431.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="589.5" y="451.7529">Stripe</text><rect fill="#FFFFFF" filter="url(#f1k03ztkfhq18d)" height="318.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="26.5" y="96.2969"/><rect fill="#FFFFFF" filter="url(#f1k03ztkfhq18d)" height="297.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="139.5" y="117.4297"/><rect fill="#FFFFFF" filter="url(#f1k03ztkfhq18d)" height="126.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="360.5" y="259.0938"/><rect fill="#FFFFFF" filter="url(#f1k03ztkfhq18d)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="473.5" y="200.8281"/><rect fill="#FFFFFF" filter="url(#f1k03ztkfhq18d)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="607.5" y="288.2266"/><polygon fill="#A80036" points="127.5,113.4297,137.5,117.4297,127.5,121.4297,131.5,117.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="36.5" x2="133.5" y1="117.4297" y2="117.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="43.5" y="112.3638">GET /sources</text><path d="M154,130.4297 L154,170.4297 L483,170.4297 L483,140.4297 L473,130.4297 L154,130.4297 " fill="#FBFB77" filter="url(#f1k03ztkfhq18d)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M473,130.4297 L473,140.4297 L483,140.4297 L473,130.4297 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="308" x="160" y="147.4966">{name} identifies the user (from Oauth2 auth.)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="289" x="160" y="162.6294">and is equivalent to the users email address</text><polygon fill="#A80036" points="461.5,196.8281,471.5,200.8281,461.5,204.8281,465.5,200.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="149.5" x2="467.5" y1="200.8281" y2="200.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="156.5" y="195.7622">getPaymentId(name)</text><polygon fill="#A80036" points="160.5,225.9609,150.5,229.9609,160.5,233.9609,156.5,229.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="154.5" x2="477.5" y1="229.9609" y2="229.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="166.5" y="224.895">{paymentId}</text><polygon fill="#A80036" points="348.5,255.0938,358.5,259.0938,348.5,263.0938,352.5,259.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="149.5" x2="354.5" y1="259.0938" y2="259.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="156.5" y="254.0278">getSavedSources(paymentId)</text><polygon fill="#A80036" points="595.5,284.2266,605.5,288.2266,595.5,292.2266,599.5,288.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="370.5" x2="601.5" y1="288.2266" y2="288.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="377.5" y="283.1606">GET /v1/customers/&lt;paymentId&gt;</text><polygon fill="#A80036" points="381.5,313.3594,371.5,317.3594,381.5,321.3594,377.5,317.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="375.5" x2="611.5" y1="317.3594" y2="317.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="387.5" y="312.2935">{customer}</text><path d="M375,330.3594 L375,355.3594 L710,355.3594 L710,340.3594 L700,330.3594 L375,330.3594 " fill="#FBFB77" filter="url(#f1k03ztkfhq18d)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M700,330.3594 L700,340.3594 L710,340.3594 L700,330.3594 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="314" x="381" y="347.4263">The {customer} object includes a list of sources</text><polygon fill="#A80036" points="160.5,381.625,150.5,385.625,160.5,389.625,156.5,385.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="154.5" x2="364.5" y1="385.625" y2="385.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="166.5" y="380.5591">[{source}, ... ]</text><polygon fill="#A80036" points="42.5,410.7578,32.5,414.7578,42.5,418.7578,38.5,414.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="36.5" x2="143.5" y1="414.7578" y2="414.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="48.5" y="409.6919">{result}</text><!--
@startuml

actor Client
participant Client

box "Prime"
    participant "client-api"
    participant "payment-processor"
    participant "DAO"
end box
participant Stripe

activate Client
    Client -> "client-api": GET /sources
    activate "client-api"
    note right of "client-api"
       {name} identifies the user (from Oauth2 auth.)
       and is equivalent to the users email address
    end note

    "client-api" -> DAO : getPaymentId(name)
    activate DAO
    DAO -> "client-api" : {paymentId}
    deactivate DAO

    "client-api" -> "payment-processor" : getSavedSources(paymentId)
    activate "payment-processor"

    "payment-processor" -> Stripe : GET /v1/customers/<paymentId>
    activate Stripe
    Stripe -> "payment-processor" : {customer}
    deactivate Stripe
    note right of "payment-processor" : The {customer} object includes a list of sources

    "payment-processor" -> "client-api" :  [{source}, ... ]
    deactivate "payment-processor"

    "client-api" -> Client : {result}
    deactivate "client-api"

deactivate Client

@enduml

PlantUML version 1.2018.08(Sun Jun 24 14:31:00 CEST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_171-8u171-b11-0ubuntu0.17.10.1-b11
Operating System: Linux
OS Version: 4.13.0-46-generic
Default Encoding: UTF-8
Language: nb
Country: NO
--></g></svg>