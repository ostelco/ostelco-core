<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="876px" preserveAspectRatio="none" style="width:1246px;height:876px;" version="1.1" viewBox="0 0 1246 876" width="1246px" zoomAndPan="magnify"><defs><filter height="300%" id="f1mnnclrp6bqx1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="861.3203" style="stroke: #A80036; stroke-width: 1.0;" width="757" x="155.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="512.5" y="16.0669">Prime</text><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="664.7266" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="26.5" y="96.2969"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="601.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="196.5" y="159.5625"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="314.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="533.5" y="417.7578"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="819.5" y="612.6875"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="878.5" y="242.9609"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="878.5" y="301.2266"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="878.5" y="359.4922"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="41.6992" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="878.5" y="529.2891"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1189.5" y="471.0234"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="271" style="stroke: #000000; stroke-width: 2.0;" width="784" x="450.5" y="432.7578"/><rect fill="#FFFFFF" height="53.9375" style="stroke: none; stroke-width: 1.0;" width="784" x="450.5" y="649.8203"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="31" x2="31" y1="86.2969" y2="779.0234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="201.5" x2="201.5" y1="86.2969" y2="779.0234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="538.5" x2="538.5" y1="86.2969" y2="779.0234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="824.5" x2="824.5" y1="86.2969" y2="779.0234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="883.5" x2="883.5" y1="86.2969" y2="779.0234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1194.5" x2="1194.5" y1="86.2969" y2="779.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="8" y="82.9951">Client</text><ellipse cx="31.5" cy="13" fill="#FEFECE" filter="url(#f1mnnclrp6bqx1)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M31.5,21 L31.5,48 M18.5,29 L44.5,29 M31.5,48 L18.5,63 M31.5,48 L44.5,63 " fill="none" filter="url(#f1mnnclrp6bqx1)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="8" y="791.0186">Client</text><ellipse cx="31.5" cy="804.3203" fill="#FEFECE" filter="url(#f1mnnclrp6bqx1)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M31.5,812.3203 L31.5,839.3203 M18.5,820.3203 L44.5,820.3203 M31.5,839.3203 L18.5,854.3203 M31.5,839.3203 L44.5,854.3203 " fill="none" filter="url(#f1mnnclrp6bqx1)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1mnnclrp6bqx1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="80" x="159.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="166.5" y="70.9951">client-api</text><rect fill="#FEFECE" filter="url(#f1mnnclrp6bqx1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="80" x="159.5" y="778.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="166.5" y="798.0186">client-api</text><rect fill="#FEFECE" filter="url(#f1mnnclrp6bqx1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="460.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="467.5" y="70.9951">payment-processor</text><rect fill="#FEFECE" filter="url(#f1mnnclrp6bqx1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="460.5" y="778.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="467.5" y="798.0186">payment-processor</text><rect fill="#FEFECE" filter="url(#f1mnnclrp6bqx1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="800.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="807.5" y="70.9951">OCS</text><rect fill="#FEFECE" filter="url(#f1mnnclrp6bqx1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="800.5" y="778.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="807.5" y="798.0186">OCS</text><rect fill="#FEFECE" filter="url(#f1mnnclrp6bqx1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="46" x="858.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="865.5" y="70.9951">DAO</text><rect fill="#FEFECE" filter="url(#f1mnnclrp6bqx1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="46" x="858.5" y="778.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="865.5" y="798.0186">DAO</text><rect fill="#FEFECE" filter="url(#f1mnnclrp6bqx1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1164.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1171.5" y="70.9951">Stripe</text><rect fill="#FEFECE" filter="url(#f1mnnclrp6bqx1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1164.5" y="778.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1171.5" y="798.0186">Stripe</text><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="664.7266" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="26.5" y="96.2969"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="601.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="196.5" y="159.5625"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="314.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="533.5" y="417.7578"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="819.5" y="612.6875"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="878.5" y="242.9609"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="878.5" y="301.2266"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="878.5" y="359.4922"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="41.6992" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="878.5" y="529.2891"/><rect fill="#FFFFFF" filter="url(#f1mnnclrp6bqx1)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1189.5" y="471.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="36.5" x2="78.5" y1="117.4297" y2="117.4297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="78.5" x2="78.5" y1="117.4297" y2="130.4297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="37.5" x2="78.5" y1="130.4297" y2="130.4297"/><polygon fill="#A80036" points="47.5,126.4297,37.5,130.4297,47.5,134.4297,43.5,130.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="43.5" y="112.3638">Select product ({sku})</text><polygon fill="#A80036" points="184.5,155.5625,194.5,159.5625,184.5,163.5625,188.5,159.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="36.5" x2="190.5" y1="159.5625" y2="159.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="43.5" y="154.4966">POST /products {sku}</text><path d="M211,172.5625 L211,212.5625 L540,212.5625 L540,182.5625 L530,172.5625 L211,172.5625 " fill="#FBFB77" filter="url(#f1mnnclrp6bqx1)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M530,172.5625 L530,182.5625 L540,182.5625 L530,172.5625 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="308" x="217" y="189.6294">{name} identifies the user (from Oauth2 auth.)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="289" x="217" y="204.7622">and is equivalent to the users email address</text><polygon fill="#A80036" points="866.5,238.9609,876.5,242.9609,866.5,246.9609,870.5,242.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="206.5" x2="872.5" y1="242.9609" y2="242.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="213.5" y="237.895">getPaymentId(name)</text><polygon fill="#A80036" points="217.5,268.0938,207.5,272.0938,217.5,276.0938,213.5,272.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="211.5" x2="882.5" y1="272.0938" y2="272.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="223.5" y="267.0278">{paymentId}</text><polygon fill="#A80036" points="866.5,297.2266,876.5,301.2266,866.5,305.2266,870.5,301.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="206.5" x2="872.5" y1="301.2266" y2="301.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="213.5" y="296.1606">getDefaultSource(name)</text><polygon fill="#A80036" points="217.5,326.3594,207.5,330.3594,217.5,334.3594,213.5,330.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="211.5" x2="882.5" y1="330.3594" y2="330.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="223.5" y="325.2935">{sourceId}</text><polygon fill="#A80036" points="866.5,355.4922,876.5,359.4922,866.5,363.4922,870.5,359.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="206.5" x2="872.5" y1="359.4922" y2="359.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="213.5" y="354.4263">getProduct(sku)</text><polygon fill="#A80036" points="217.5,384.625,207.5,388.625,217.5,392.625,213.5,388.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="211.5" x2="882.5" y1="388.625" y2="388.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="223.5" y="383.5591">{product}</text><polygon fill="#A80036" points="521.5,413.7578,531.5,417.7578,521.5,421.7578,525.5,417.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="206.5" x2="527.5" y1="417.7578" y2="417.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="308" x="213.5" y="412.6919">purchaseProduct(paymentId, sourceId, product)</text><path d="M450.5,432.7578 L514.5,432.7578 L514.5,439.7578 L504.5,449.7578 L450.5,449.7578 L450.5,432.7578 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="271" style="stroke: #000000; stroke-width: 2.0;" width="784" x="450.5" y="432.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="465.5" y="445.8247">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="109" x="529.5" y="444.9683">[successful case]</text><polygon fill="#A80036" points="1177.5,467.0234,1187.5,471.0234,1177.5,475.0234,1181.5,471.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="543.5" x2="1183.5" y1="471.0234" y2="471.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="627" x="550.5" y="465.9575">POST /v1/charges {paymentId, sourceId, product.amount, product.currency, product.description}</text><polygon fill="#A80036" points="554.5,496.1563,544.5,500.1563,554.5,504.1563,550.5,500.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="548.5" x2="1193.5" y1="500.1563" y2="500.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="560.5" y="495.0903">{chargeInfo}</text><polygon fill="#A80036" points="866.5,525.2891,876.5,529.2891,866.5,533.2891,870.5,529.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="543.5" x2="872.5" y1="529.2891" y2="529.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="269" x="550.5" y="524.2231">recordChargeInfo(paymentId, chargeInfo)</text><polygon fill="#A80036" points="554.5,566.9883,544.5,570.9883,554.5,574.9883,550.5,570.9883" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="548.5" x2="882.5" y1="570.9883" y2="570.9883"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="560.5" y="565.9224">{result}</text><path d="M893,542.2891 L893,582.2891 L1118,582.2891 L1118,552.2891 L1108,542.2891 L893,542.2891 " fill="#FBFB77" filter="url(#f1mnnclrp6bqx1)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1108,542.2891 L1108,552.2891 L1118,552.2891 L1108,542.2891 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="899" y="559.356">Charges/refunds to be recorded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="899" y="574.4888">in a "ledger" type of store</text><polygon fill="#A80036" points="807.5,608.6875,817.5,612.6875,807.5,616.6875,811.5,612.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="543.5" x2="813.5" y1="612.6875" y2="612.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="257" x="550.5" y="607.6216">updateBucket(paymentId, product.size)</text><polygon fill="#A80036" points="554.5,637.8203,544.5,641.8203,554.5,645.8203,550.5,641.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="548.5" x2="823.5" y1="641.8203" y2="641.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="560.5" y="636.7544">{result}</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="450.5" x2="1234.5" y1="650.8203" y2="650.8203"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="455.5" y="661.0308">[error]</text><path d="M548,669.625 L548,694.625 L799,694.625 L799,679.625 L789,669.625 L548,669.625 " fill="#FBFB77" filter="url(#f1mnnclrp6bqx1)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M789,669.625 L789,679.625 L799,679.625 L789,669.625 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="554" y="686.6919">Unroll charge with Stripe etc. (TBD)</text><polygon fill="#A80036" points="217.5,727.8906,207.5,731.8906,217.5,735.8906,213.5,731.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="211.5" x2="537.5" y1="731.8906" y2="731.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="223.5" y="726.8247">{result}</text><polygon fill="#A80036" points="42.5,757.0234,32.5,761.0234,42.5,765.0234,38.5,761.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="36.5" x2="200.5" y1="761.0234" y2="761.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="48.5" y="755.9575">{result}</text><!--
@startuml

actor Client
participant Client

box "Prime"
    participant "client-api"
    participant "payment-processor"
    participant OCS
    participant DAO
end box
participant Stripe

activate Client

    Client -> Client : Select product ({sku})

    Client -> "client-api": POST /products {sku}
    activate "client-api"
    note right of "client-api"
       {name} identifies the user (from Oauth2 auth.)
       and is equivalent to the users email address
    end note

    "client-api" -> DAO : getPaymentId(name)
    activate DAO
    DAO -> "client-api" : {paymentId}
    deactivate DAO

    "client-api" -> DAO : getDefaultSource(name)
    activate DAO
    DAO -> "client-api" : {sourceId}
    deactivate DAO

    "client-api" -> DAO : getProduct(sku)
    activate DAO
    DAO -> "client-api" : {product}
    deactivate DAO

    "client-api" -> "payment-processor" : purchaseProduct(paymentId, sourceId, product)
    activate "payment-processor"

    alt successful case
        "payment-processor" -> Stripe : POST /v1/charges {paymentId, sourceId, product.amount, product.currency, product.description}
        activate Stripe
        Stripe -> "payment-processor" : {chargeInfo}
        deactivate Stripe

        "payment-processor" -> DAO: recordChargeInfo(paymentId, chargeInfo)
        activate DAO
        DAO -> "payment-processor" : {result}
        deactivate DAO
        note right
          Charges/refunds to be recorded
          in a "ledger" type of store
        end note

        "payment-processor" -> OCS : updateBucket(paymentId, product.size)
        activate OCS
        OCS -> "payment-processor" : {result}
        deactivate OCS

    else error
         note right of "payment-processor" : Unroll charge with Stripe etc. (TBD)

    end

    "payment-processor" -> "client-api" : {result}
    deactivate "payment-processor"

    "client-api" -> Client : {result}
    deactivate "client-api"

deactivate Client

@enduml

PlantUML version 1.2018.08(Sun Jun 24 14:31:00 CEST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_171-8u171-b11-0ubuntu0.17.10.1-b11
Operating System: Linux
OS Version: 4.13.0-46-generic
Default Encoding: UTF-8
Language: nb
Country: NO
--></g></svg>